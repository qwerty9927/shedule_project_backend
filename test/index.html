<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
</head>

<body>
	<table class="body-table" style="border-collapse: collapse;" rules="all" border="1" cellspacing="0" cellpadding="0">
		<tbody><tr style="">
		<td width="25px" align="center"><input type="checkbox" id="chk_84104701  01" value="84104701  01|841047|Công nghệ phần mềm|01|4|4|01/01/0001|0|0|0||0|DCT120" disabled="" onclick="toDKSelectedChange(this)"></td>
		
		<td width="60px" align="center">841047</td>
		<td width="150x" align="left">&nbsp;Công nghệ phần mềm</td> <td width="35px" align="center">01</td><td width="30px" align="center">01</td><td width="25px" align="center">4</td><td width="35px" align="center">4</td><td width="56px" align="center">DCT1201</td><td width="28px" align="center">81</td> <td width="28px" align="center">Hết</td>
		<td width="20px" align="center"><div class="top-fline">*</div><div class="fline">&nbsp;</div><div class="top-fline"></div></td>
		<td width="35px" align="center"><div class="top-fline">Tư</div><div class="fline">&nbsp;</div><div class="top-fline">Ba</div> </td>
		<td width="40px" align="center"><div class="top-fline">4</div><div class="fline">&nbsp;</div><div class="top-fline">3</div></td>
		<td width="30px" align="center"><div class="top-fline">2</div><div class="fline">&nbsp;</div><div class="top-fline">3</div></td>
		<td width="60px" align="center"><div class="top-fline">C.E402</div><div class="fline">&nbsp;</div><div class="top-fline">C.E203</div></td><td width="35px" align="center"><div class="top-fline">N.T.Huy</div><div class="fline">&nbsp;</div><div class="top-fline">N.T.Huy</div></td> <td style="font-size: 12px; font-family: Courier" align="left"><div class="top-fline"><label id="05/09/2022--18/12/2022" style="cursor:pointer" onmouseover="ddrivetip(this.id)" onmouseout="hideddrivetip()">123456789012345</label></div><div class="fline">&nbsp;</div><div class="top-fline"><label id="05/09/2022--18/12/2022" style="cursor:pointer" onmouseover="ddrivetip(this.id)" onmouseout="hideddrivetip()">123456789012345</label></div></td></tr></tbody></table>
<table class="body-table" style="border-collapse: collapse;" rules="all" border="1" cellspacing="0" cellpadding="0">
		<tbody><tr style="">
		<td width="25px" align="center"><input type="checkbox" id="chk_84104702  01" value="84104702  01|841047|Công nghệ phần mềm|02|4|4|01/01/0001|0|0|0||0|DCT120" disabled="" onclick="toDKSelectedChange(this)"></td>
		
		<td width="60px" align="center">841047</td>
		<td width="150x" align="left">&nbsp;Công nghệ phần mềm</td> <td width="35px" align="center">02</td><td width="30px" align="center">01</td><td width="25px" align="center">4</td><td width="35px" align="center">4</td><td width="56px" align="center">DCT1202</td><td width="28px" align="center">80</td> <td width="28px" align="center">9</td>
		<td width="20px" align="center"><div class="top-fline">*</div><div class="fline">&nbsp;</div><div class="top-fline"></div></td>
		<td width="35px" align="center"><div class="top-fline">Bảy</div><div class="fline">&nbsp;</div><div class="top-fline">Bảy</div> </td>
		<td width="40px" align="center"><div class="top-fline">4</div><div class="fline">&nbsp;</div><div class="top-fline">1</div></td>
		<td width="30px" align="center"><div class="top-fline">2</div><div class="fline">&nbsp;</div><div class="top-fline">3</div></td>
		<td width="60px" align="center"><div class="top-fline">C.A016</div><div class="fline">&nbsp;</div><div class="top-fline">C.A016</div></td><td width="35px" align="center"><div class="top-fline">N.T.Huy</div><div class="fline">&nbsp;</div><div class="top-fline">N.T.Huy</div></td> <td style="font-size: 12px; font-family: Courier" align="left"><div class="top-fline"><label id="05/09/2022--18/12/2022" style="cursor:pointer" onmouseover="ddrivetip(this.id)" onmouseout="hideddrivetip()">123456789012345</label></div><div class="fline">&nbsp;</div><div class="top-fline"><label id="05/09/2022--18/12/2022" style="cursor:pointer" onmouseover="ddrivetip(this.id)" onmouseout="hideddrivetip()">123456789012345</label></div></td></tr></tbody></table>
<table class="body-table" style="border-collapse: collapse;" rules="all" border="1" cellspacing="0" cellpadding="0">
		<tbody><tr style="">
		<td width="25px" align="center"><input type="checkbox" id="chk_84104704  01" value="84104704  01|841047|Công nghệ phần mềm|04|4|4|01/01/0001|0|0|0||0|DCT120" disabled="" onclick="toDKSelectedChange(this)"></td>
		
		<td width="60px" align="center">841047</td>
		<td width="150x" align="left">&nbsp;Công nghệ phần mềm</td> <td width="35px" align="center">04</td><td width="30px" align="center">01</td><td width="25px" align="center">4</td><td width="35px" align="center">4</td><td width="56px" align="center">DCT1204</td><td width="28px" align="center">110</td> <td width="28px" align="center">1</td>
		<td width="20px" align="center"><div class="top-fline">*</div><div class="fline">&nbsp;</div><div class="top-fline"></div></td>
		<td width="35px" align="center"><div class="top-fline">Bảy</div><div class="fline">&nbsp;</div><div class="top-fline">Bảy</div> </td>
		<td width="40px" align="center"><div class="top-fline">6</div><div class="fline">&nbsp;</div><div class="top-fline">8</div></td>
		<td width="30px" align="center"><div class="top-fline">2</div><div class="fline">&nbsp;</div><div class="top-fline">3</div></td>
		<td width="60px" align="center"><div class="top-fline">C.E402</div><div class="fline">&nbsp;</div><div class="top-fline">C.HTC</div></td><td width="35px" align="center"><div class="top-fline">N.Q.Huy</div><div class="fline">&nbsp;</div><div class="top-fline">N.Q.Huy</div></td> <td style="font-size: 12px; font-family: Courier" align="left"><div class="top-fline"><label id="05/09/2022--18/12/2022" style="cursor:pointer" onmouseover="ddrivetip(this.id)" onmouseout="hideddrivetip()">123456789012345</label></div><div class="fline">&nbsp;</div><div class="top-fline"><label id="05/09/2022--18/12/2022" style="cursor:pointer" onmouseover="ddrivetip(this.id)" onmouseout="hideddrivetip()">123456789012345</label></div></td></tr></tbody></table>
<table class="body-table" style="border-collapse: collapse;" rules="all" border="1" cellspacing="0" cellpadding="0">
		<tbody><tr style="background-color:#CCCCCC">
		<td width="25px" align="center"><input type="checkbox" id="chk_84104705  01" value="84104705  01|841047|Công nghệ phần mềm|05|4|4|01/01/0001|0|0|0||0|DCT120" checked="" disabled="" onclick="toDKSelectedChange(this)"></td>
		
		<td width="60px" align="center">841047</td>
		<td width="150x" align="left">&nbsp;Công nghệ phần mềm</td> <td width="35px" align="center">05</td><td width="30px" align="center">01</td><td width="25px" align="center">4</td><td width="35px" align="center">4</td><td width="56px" align="center">DCT1201</td><td width="28px" align="center">120</td> <td width="28px" align="center">Hết</td>
		<td width="20px" align="center"><div class="top-fline">*</div><div class="fline">&nbsp;</div><div class="top-fline"></div></td>
		<td width="35px" align="center"><div class="top-fline">Bảy</div><div class="fline">&nbsp;</div><div class="top-fline">Bảy</div> </td>
		<td width="40px" align="center"><div class="top-fline">1</div><div class="fline">&nbsp;</div><div class="top-fline">3</div></td>
		<td width="30px" align="center"><div class="top-fline">2</div><div class="fline">&nbsp;</div><div class="top-fline">3</div></td>
		<td width="60px" align="center"><div class="top-fline">C.C105</div><div class="fline">&nbsp;</div><div class="top-fline">C.C103</div></td><td width="35px" align="center"><div class="top-fline">N.Q.Huy</div><div class="fline">&nbsp;</div><div class="top-fline">N.Q.Huy</div></td> <td style="font-size: 12px; font-family: Courier" align="left"><div class="top-fline"><label id="05/09/2022--18/12/2022" style="cursor:pointer" onmouseover="ddrivetip(this.id)" onmouseout="hideddrivetip()">123456789012345</label></div><div class="fline">&nbsp;</div><div class="top-fline"><label id="05/09/2022--18/12/2022" style="cursor:pointer" onmouseover="ddrivetip(this.id)" onmouseout="hideddrivetip()">123456789012345</label></div></td></tr></tbody></table>
<table class="body-table" style="border-collapse: collapse;" rules="all" border="1" cellspacing="0" cellpadding="0">
		<tbody><tr style="">
		<td width="25px" align="center"><input type="checkbox" id="chk_84104706  01" value="84104706  01|841047|Công nghệ phần mềm|06|4|4|01/01/0001|0|0|0||0|DCT120" disabled="" onclick="toDKSelectedChange(this)"></td>
		
		<td width="60px" align="center">841047</td>
		<td width="150x" align="left">&nbsp;Công nghệ phần mềm</td> <td width="35px" align="center">06</td><td width="30px" align="center">01</td><td width="25px" align="center">4</td><td width="35px" align="center">4</td><td width="56px" align="center">DCT1202</td><td width="28px" align="center">70</td> <td width="28px" align="center">3</td>
		<td width="20px" align="center"><div class="top-fline">*</div><div class="fline">&nbsp;</div><div class="top-fline"></div></td>
		<td width="35px" align="center"><div class="top-fline">Sáu</div><div class="fline">&nbsp;</div><div class="top-fline">Năm</div> </td>
		<td width="40px" align="center"><div class="top-fline">4</div><div class="fline">&nbsp;</div><div class="top-fline">6</div></td>
		<td width="30px" align="center"><div class="top-fline">2</div><div class="fline">&nbsp;</div><div class="top-fline">3</div></td>
		<td width="60px" align="center"><div class="top-fline">C.A110</div><div class="fline">&nbsp;</div><div class="top-fline">C.E203</div></td><td width="35px" align="center"><div class="top-fline">N.Q.Huy</div><div class="fline">&nbsp;</div><div class="top-fline">N.Q.Huy</div></td> <td style="font-size: 12px; font-family: Courier" align="left"><div class="top-fline"><label id="05/09/2022--18/12/2022" style="cursor:pointer" onmouseover="ddrivetip(this.id)" onmouseout="hideddrivetip()">123456789012345</label></div><div class="fline">&nbsp;</div><div class="top-fline"><label id="05/09/2022--18/12/2022" style="cursor:pointer" onmouseover="ddrivetip(this.id)" onmouseout="hideddrivetip()">123456789012345</label></div></td></tr></tbody></table>

	<input type="text" id="txtMaMH1">
	<button id="btnLocTheoMaMH1" onclick="receive()">Send</button>
	<script>
		function receive() {
			console.log("data")
		}
		function handleData(data){
			const formatData = []
			Array.from(data).map((itemRoot, indexRoot) => {
				const subData = Array.from(itemRoot.children[0].children[0].children).map((item, index) => {
					if(item.nodeName === "TD"){
						return item.textContent.replace(/\n\t+/mg, "")
					}
				})
				const newSubData = []
				subData.forEach((item, index) => {
					if(index > 10){
						const tempArr = item.split(/\s/)
						if(tempArr.length > 1){
							newSubData[index] = tempArr.filter(subItem => subItem)
						} else {
							newSubData[index] = item
						}
					} else {
						newSubData[index] = item
					}
				})
				formatData.push(newSubData)
			})
			return formatData
		}
		function send() {
			console.log("start")
			const array = [841047]
			const interval = setInterval(() => {
				if (array.length === 0) {
					console.log("start clear")
					clearInterval(interval)
					console.log("end clear")
				} else {
					const input = document.querySelector('#txtMaMH1')
					const button = document.querySelector('#btnLocTheoMaMH1')
					const data = document.querySelectorAll('.body-table')
					// const data = document.querySelectorAll('#divTDK > .body-table')
					const formatData = handleData(data)
					fetch('http://localhost:3000/', {
						method: "POST",
						mode: "no-cors",
						headers: {
							// 'Content-Type': 'application/json'
							'Content-Type': 'application/x-www-form-urlencoded',
						},
						body: `values=${JSON.stringify(formatData)}`
					})
					console.log(formatData)
					input.value = array[0]
					array.shift()
					button.click()
				}
			}, 3000)
		}
	</script>
</body>

</html>